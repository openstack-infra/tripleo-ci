---
# zuul.d/build-containers.yaml
# Zuul layout for TripleO Build Containers jobs.

- project-template:
    name: tripleo-ci-build-containers-jobs
    check:
      jobs:
        - tripleo-build-containers-centos-7
        - tripleo-build-containers-centos-7-train
        - tripleo-build-containers-centos-7-stein
        - tripleo-build-containers-centos-7-rocky
        - tripleo-build-containers-centos-7-buildah
        - tripleo-build-containers-centos-7-buildah-train
        - tripleo-build-containers-centos-7-buildah-stein
    gate:
      queue: tripleo
      jobs:
        - tripleo-build-containers-centos-7
        - tripleo-build-containers-centos-7-train
        - tripleo-build-containers-centos-7-stein
        - tripleo-build-containers-centos-7-rocky
        - tripleo-build-containers-centos-7-buildah
        - tripleo-build-containers-centos-7-buildah-stein
        - tripleo-build-containers-centos-7-buildah-train

- project-template:
    name: tripleo-build-containers-jobs
    check:
      jobs:
        - tripleo-build-containers-centos-7
        - tripleo-build-containers-centos-7-buildah
    gate:
      queue: tripleo
      jobs:
        - tripleo-build-containers-centos-7
        - tripleo-build-containers-centos-7-buildah

- project-template:
    name: tripleo-build-containers-jobs-train
    check:
      jobs:
        - tripleo-build-containers-centos-7-train
        - tripleo-build-containers-centos-7-buildah-train
    gate:
      queue: tripleo
      jobs:
        - tripleo-build-containers-centos-7-train
        - tripleo-build-containers-centos-7-buildah-train

- project-template:
    name: tripleo-build-containers-jobs-stein
    check:
      jobs:
        - tripleo-build-containers-centos-7-stein
        - tripleo-build-containers-centos-7-buildah-stein
    gate:
      queue: tripleo
      jobs:
        - tripleo-build-containers-centos-7-stein
        - tripleo-build-containers-centos-7-buildah-stein

- project-template:
    name: tripleo-build-containers-jobs-rocky
    check:
      jobs:
        - tripleo-build-containers-centos-7-rocky
    gate:
      queue: tripleo
      jobs:
        - tripleo-build-containers-centos-7-rocky

- job:
    name: tripleo-build-containers-centos-7
    parent: tripleo-build-containers-base-with-files
    nodeset: single-centos-7-node
    branches: ^(?!stable/(pike|queens)).*$
    voting: true

- job:
    name: tripleo-build-containers-centos-7-train
    parent: tripleo-build-containers-centos-7
    override-checkout: stable/train
    vars:
      branch_override: stable/train

- job:
    name: tripleo-build-containers-centos-7-stein
    parent: tripleo-build-containers-centos-7
    override-checkout: stable/stein
    vars:
      branch_override: stable/stein

- job:
    name: tripleo-build-containers-centos-7-rocky
    parent: tripleo-build-containers-centos-7
    override-checkout: stable/rocky
    vars:
      branch_override: stable/rocky

- job:
    name: tripleo-build-containers-centos-7-buildah
    description: |
      container build job (buildah cli/backend)
    parent: tripleo-build-containers-centos-7
    vars:
      use_buildah: true

- job:
    name: tripleo-build-containers-centos-7-buildah-train
    parent: tripleo-build-containers-centos-7-buildah
    override-checkout: stable/train
    vars:
      branch_override: stable/train

- job:
    name: tripleo-build-containers-centos-7-buildah-stein
    parent: tripleo-build-containers-centos-7-buildah
    override-checkout: stable/stein
    vars:
      branch_override: stable/stein
