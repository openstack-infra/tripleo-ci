---
# zuul.d/deprecated-jobs.yaml
# Zuul layout for TripleO deprecated jobs.
# It contains all the deprecated jobs that should be removed from Zuul.

- job:
    name: tripleo-ci-deprecated-standalone
    description: |
      Deprecated TripleO Job
      Job no longer supported that should be removed from Zuul config.
    parent: tripleo-ci-base-standalone
    pre-run: playbooks/deprecated/pre.yaml

- job:
    name: tripleo-ci-deprecated
    description: |
      Deprecated TripleO Job
      Job no longer supported that should be removed from Zuul config.
    parent: tripleo-ci-base-multinode
    pre-run: playbooks/deprecated/pre.yaml

# TODO(rfolco): non-containeirized (nc) scenarios are no longer supported.
# These (nc) scenario jobs ran until ocata release and should be removed
# or replaced by containerized scenario jobs *-container.
- job:
    name: tripleo-ci-centos-7-scenario001-multinode-oooq
    parent: tripleo-ci-deprecated
    branches: none/deprecated
    vars:
      nodes: 1ctlr
      featureset: '005'

- job:
    name: tripleo-ci-centos-7-scenario002-multinode-oooq
    parent: tripleo-ci-deprecated
    branches: none/deprecated
    vars:
      nodes: 1ctlr
      featureset: '006'

- job:
    name: tripleo-ci-centos-7-scenario003-multinode-oooq
    parent: tripleo-ci-deprecated
    branches: none/deprecated
    vars:
      nodes: 1ctlr
      featureset: '007'

- job:
    name: tripleo-ci-centos-7-scenario004-multinode-oooq
    parent: tripleo-ci-deprecated
    branches: none/deprecated
    vars:
      nodes: 1ctlr
      featureset: '008'

- job:
    name: tripleo-ci-centos-7-scenario007-multinode-oooq
    parent: tripleo-ci-deprecated
    branches: none/deprecated
    vars:
      nodes: 1ctlr
      featureset: '028'

- job:
    name: tripleo-ci-centos-7-scenario008-multinode-oooq
    parent: tripleo-ci-deprecated
    voting: false
    branches: none/deprecated
    vars:
      nodes: 1ctlr
      featureset: '031'

- job:
    name: tripleo-ci-centos-7-containers-multinode-queens
    parent: tripleo-ci-base-multinode
    voting: false
    branches: master
    override-checkout: 'stable/queens'
    vars:
      branch_override: 'stable/queens'
      nodes: 1ctlr
      featureset: '010'
      playbooks:
        - multinode.yml

- job:
    name: tripleo-ci-centos-7-containers-multinode-train
    parent: tripleo-ci-base-multinode
    timeout: 10800
    voting: false
    branches: master
    override-checkout: 'stable/train'
    vars:
      branch_override: 'stable/train'
      nodes: 1ctlr
      featureset: '010'
      playbooks:
        - multinode.yml

- job:
    name: tripleo-ci-centos-7-nonha-multinode-oooq
    parent: tripleo-ci-deprecated
    branches: none/deprecated
    vars:
      nodes: 1ctlr
      featureset: '004'

# TODO(rfolco): scen00{6,9} are containeirized, remove this when
# all projects using them rename to the *-container (dup) jobs
- job:
    name: tripleo-ci-centos-7-scenario006-multinode-oooq
    parent: tripleo-ci-deprecated
    voting: false
    branches: ^(?!stable/(newton|ocata)).*$
    vars:
      nodes: 1ctlr
      featureset: '026'

- job:
    name: tripleo-ci-centos-7-scenario009-multinode-oooq
    parent: tripleo-ci-deprecated
    voting: false
    branches: ^(?!stable/(newton|ocata)).*$
    vars:
      nodes: 1ctlr
      featureset: '033'

- job:
    name: tripleo-ci-centos-7-containers-multinode-pike
    parent: tripleo-ci-deprecated
    branches: master
    override-checkout: 'stable/pike'
    vars:
      branch_override: 'stable/pike'
      nodes: 1ctlr
      featureset: '010'
      playbooks:
        - multinode.yml

- job:
    name: tripleo-ci-centos-7-scenario012-standalone
    voting: false
    parent: tripleo-ci-base-standalone
    nodeset: single-centos-7-node
    branches: ^(?!stable/(newton|ocata|pike|queens|rocky|stein|train)).*$
    vars:
      featureset: '060'
      standalone_ceph: true

- job:
    name: tripleo-ci-centos-7-scenario009-multinode-oooq-container
    parent: tripleo-ci-base-multinode
    voting: false
    branches: ^(stable/(queens|rocky|stein|train)).*$
    vars:
      nodes: 1ctlr
      featureset: '033'

- job:
    name: tripleo-ci-centos-7-containers-undercloud-minion
    parent: tripleo-ci-deprecated
    branches: none/deprecated
    vars:
      nodes: 1minion
      featureset: '061'
      playbooks:
        - multinode-minion.yml
      extra_tags:
        - undercloud-minion-setup
        - undercloud-minion-deploy

- job:
    name: tripleo-ci-centos-7-scenario007-standalone
    voting: true
    parent: tripleo-ci-deprecated
    nodeset: single-centos-7-node
    branches: none/deprecated
    vars:
      featureset: '052'
      featureset_override:
        run_tempest: false
        standalone_environment_files:
          - 'environments/low-memory-usage.yaml'
          - 'ci/environments/scenario007-standalone.yaml'
        tempest_services:
          - neutron
        tempest_test_whitelist:
          - 'tempest.scenario.test_network_basic_ops.TestNetworkBasicOps.test_network_basic_ops'
        tempest_private_net_provider_type: 'vxlan'
        use_os_tempest: true

- job:
    name: tripleo-ci-centos-8-standalone-upgrade
    parent: tripleo-ci-base-standalone-upgrade-centos-8
    voting: false
    branches: ^master$
    vars:
      featureset: '056'
      featureset_override:
        standalone_environment_files:
          - 'environments/low-memory-usage.yaml'
          - 'environments/docker-ha.yaml'
          - 'environments/podman.yaml'
    irrelevant-files:
      - .*molecule.*
      - ^.*\.md$
      - ^.*\.rst$
      - ^Puppetfile.*$
      - ^doc/.*$
      - ^etc/.*$
      - ^lower-constraints.txt$
      - ^metadata.json$
      - ^releasenotes/.*$
      - ^spec/.*$
      - ^test-requirements.txt$
      - ^vars/sova-patterns.yml$
      - tox.ini
      - zuul.d/ansible.yaml
      - zuul.d/build-containers.yaml
      - zuul.d/build-image.yaml
      - zuul.d/multinode-jobs.yaml
      - zuul.d/undercloud-jobs.yaml
      # like parent but with requirements.txt and setup.py removed

- job:
    name: tripleo-ci-centos-8-undercloud-upgrade
    parent: tripleo-ci-base-singlenode-centos-8
    branches: ^master$
    voting: false
    vars:
      featureset: '050'
      featureset_override:
        validate_services: false
      extra_tags:
        - undercloud-upgrade

- job:
    name: tripleo-ci-centos-8-scenario000-multinode-oooq-container-upgrades
    parent: tripleo-ci-base-multinode-centos-8
    voting: false
    branches: ^master$
    vars:
      nodes: 1ctlr
      featureset: '051'
      extra_tags:
        - overcloud-upgrade


- job:
    name: tripleo-ci-centos-7-scenario001-multinode-oooq-container
    parent: tripleo-ci-base-multinode
    branches: ^(stable/queens).*$
    voting: false
    vars:
      nodes: 1ctlr
      featureset: '016'
- job:
    name: tripleo-ci-centos-7-scenario002-multinode-oooq-container
    parent: tripleo-ci-base-multinode
    branches: ^(stable/queens).*$
    voting: false
    vars:
      nodes: 1ctlr
      featureset: '017'
- job:
    name: tripleo-ci-centos-7-scenario003-multinode-oooq-container
    parent: tripleo-ci-base-multinode
    branches: ^(stable/queens).*$
    voting: false
    vars:
      nodes: 1ctlr
      featureset: '018'
- job:
    name: tripleo-ci-centos-7-scenario004-multinode-oooq-container
    parent: tripleo-ci-base-multinode
    branches: ^(stable/queens).*$
    voting: false
    vars:
      nodes: 1ctlr
      featureset: '019'
- job:
    name: tripleo-ci-centos-7-scenario006-multinode-oooq-container
    parent: tripleo-ci-base-multinode
    voting: false
    branches: ^(stable/(queens|train)).*$
    vars:
      nodes: 1ctlr
      featureset: '026'
- job:
    name: tripleo-ci-centos-7-scenario007-multinode-oooq-container
    parent: tripleo-ci-base-multinode
    voting: false
    branches: ^stable/(queens).*$
    vars:
      nodes: 1ctlr
      featureset: '030'

- project-template:
    name: tripleo-multinode-container-minimal
    check:
      jobs:
        - tripleo-ci-centos-8-containers-multinode:
            irrelevant-files: &multinode_ignored
              - ^.*\.md$
              - ^.*\.rst$
              - ^Puppetfile.*$
              - ^doc/.*$
              - ^docs/.*$
              - ^etc/.*$
              - ^lower-constraints.txt$
              - ^metadata.json$
              - ^playbooks/deprecated/.*$
              - ^playbooks/tripleo-buildcontainers/.*$
              - ^playbooks/tripleo-buildimages/.*$
              - ^releasenotes/.*$
              - ^roles/build-containers/.*$
              - ^roles/oooci-build-images/.*$
              - ^roles/tripleo-repos/.*$
              - ^spec/.*$
              - ^test-requirements.txt$
              - ^vars/sova-patterns.yml$
              - playbooks/quickstart-extras-standalone.yml  # tripleo-quickstart-extras
              - roles/standalone-upgrade/.*
              - roles/standalone/.*
              - tox.ini
              - zuul.d/build-containers.yaml
              - zuul.d/build-image.yaml
              - zuul.d/layout.yaml
              - zuul.d/standalone-jobs.yaml
              - zuul.d/undercloud-jobs.yaml
        - tripleo-ci-centos-7-undercloud-containers:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-7-containers-multinode:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates-ussuri:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates-train:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-upgrades-ussuri:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-standalone:
            irrelevant-files: &standalone_ignored
              - ^.*\.md$
              - ^.*\.rst$
              - ^Puppetfile.*$
              - ^doc/.*$
              - ^docs/.*$
              - ^etc/.*$
              - ^lower-constraints.txt$
              - ^metadata.json$
              - ^playbooks/deprecated/.*$
              - ^playbooks/tripleo-buildcontainers/.*$
              - ^playbooks/tripleo-buildimages/.*$
              - ^releasenotes/.*$
              - ^roles/build-containers/.*$
              - ^roles/oooci-build-images/.*$
              - ^roles/tripleo-repos/.*$
              - ^spec/.*$
              - ^test-requirements.txt$
              - ^vars/sova-patterns.yml$
              - tox.ini
              - zuul.d/build-containers.yaml
              - zuul.d/build-image.yaml
              - zuul.d/layout.yaml
              - zuul.d/undercloud-jobs.yaml
              - zuul.d/multinode-jobs.yaml
        - tripleo-ci-centos-7-standalone:
            irrelevant-files: *standalone_ignored

    gate:
      queue: tripleo
      jobs:
        - tripleo-ci-centos-7-containers-multinode:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-containers-multinode:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-7-standalone:
            irrelevant-files: *standalone_ignored
        - tripleo-ci-centos-8-standalone:
            irrelevant-files: *standalone_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates-ussuri:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates-train:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-upgrades-ussuri:
            irrelevant-files: *multinode_ignored

- project-template:
    name: tripleo-multinode-baremetal-full
    gate:
      queue: tripleo

- project-template:
    name: tripleo-multinode-baremetal-minimal
    gate:
      queue: tripleo

- project-template:
    name: tripleo-multinode-container-full
    check:
      jobs:
        - tripleo-ci-centos-8-containers-multinode:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-7-containers-multinode:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-7-undercloud-containers:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-containers-undercloud-minion:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario007-multinode-oooq-container:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates-ussuri:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates-train:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-upgrades-ussuri:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-7-standalone:
            irrelevant-files: *standalone_ignored
        - tripleo-ci-centos-7-scenario001-standalone:
            irrelevant-files: *standalone_ignored
        - tripleo-ci-centos-7-scenario002-standalone:
            irrelevant-files: *standalone_ignored
        - tripleo-ci-centos-7-scenario003-standalone:
            irrelevant-files: *standalone_ignored
        - tripleo-ci-centos-7-scenario004-standalone:
            irrelevant-files: *standalone_ignored
        - tripleo-ci-centos-8-standalone:
            irrelevant-files: *standalone_ignored
        - tripleo-ci-centos-8-scenario001-standalone:
            irrelevant-files: *standalone_ignored
        - tripleo-ci-centos-8-scenario002-standalone:
            irrelevant-files: *standalone_ignored
        - tripleo-ci-centos-8-scenario003-standalone:
            irrelevant-files: *standalone_ignored
        - tripleo-ci-centos-8-scenario004-standalone:
            irrelevant-files: *standalone_ignored

    gate:
      queue: tripleo
      jobs:
        - tripleo-ci-centos-7-containers-multinode:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-containers-multinode:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-containers-undercloud-minion:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-7-standalone:
            irrelevant-files: *standalone_ignored
        - tripleo-ci-centos-8-standalone:
            irrelevant-files: *standalone_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates-ussuri:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates-train:
            irrelevant-files: *multinode_ignored
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-upgrades-ussuri:
            irrelevant-files: *multinode_ignored

- project-template:
    name: tripleo-multinode-tripleoci
    check:
      jobs:
        - tripleo-ci-centos-8-content-provider
        - tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates:
            files:
              - ^scripts/emit_releases_file/.*$
              - ^roles/run-test/.*$
              - ^roles/common/.*$
              - ^roles/tripleo-repos/.*$
            dependencies:
              - tripleo-ci-centos-8-content-provider
        - tripleo-ci-centos-8-scenario007-multinode-oooq-container:
            files:
              - ^playbooks/tripleo-ci/.*$
            dependencies:
              - tripleo-ci-centos-8-content-provider
